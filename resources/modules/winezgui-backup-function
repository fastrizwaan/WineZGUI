WineZGUI_Backup_Function()
{
  if [ -z "${1}" ]; then
        echo "Must provide Prefix or Template Directory to process"
        return 1
  else
        DIRECTORY=$(dirname  "${1}")
        DIRNAME=$(basename "${1}")
  fi      
  source ${DATADIR}/winezgui-search-replace-data
  WineZGUI_Search_Replace_Data
  
  source ${DATADIR}/winezgui-search-replace-files
  WineZGUI_Search_Replace_Files "${DIRECTORY}"

  cd "${DIRECTORY}"  
  DBUG "I: Backup: Processing files inside ${DIRNAME}"
  for (( i=0; i <${LEN}; i++ ))
      do
      sed "s/${SEARCH[$i]}/${REPLACE[$i]}/g; t;" -i ${FILE_LIST}
      #&& \
      #DBUG "I: Backup: Replaced: ${SEARCH[$i]} => ${REPLACE[$i]}"
  done

  # Rename Directory for Backup
  DSOURCE="${DIRECTORY}/drive_c/users/${USER}"
  DTARGET="${DIRECTORY}/drive_c/users/XOUSERXO"
  # Make sure that directory for the user exists, before moving
  if [ -d "${DIRECTORY}/drive_c/users/${USER}" ]; then
       mv "${DSOURCE}" "${DTARGET}" && \
       echo  "I: Backup: Renamed ${DSOURCE} to ${DTARGET}"
  fi


  # Remove H: links on Backup
  rm  "${DIRECTORY}/dosdevices/h:" && \
  DBUG "I: Backup: Removed H: symlink ${DIRNAME}/dosdevices/h:"

 # Cleanup variables
# unset LEN
# unset SSSSSSS
# unset SEARCH
# unset REPLACE
# unset FIND_EXE_PATH
# unset FPNAME
# unset WEXE
# unset WVER
# unset FILE_LIST
# unset DTARGET
# unset DSOURCE

}
