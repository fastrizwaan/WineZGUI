# winezgui-list-available-templates
# Finds exe installed in drive_c by an installer
# and set the variable SELECTED_TEMPLATE 
LIST_AVAILABLE_TEMPLATES()
{
 unset COMMAND
 unset count
 unset SHOW_OPTION
 unset NAMES
 unset FILES
 unset RESULT
 unset search_list
 
 IFS=$(echo -en "\n\b")

 count=0
 NAMES=()
 FILES=()
 # Find all exe files in drive_c Exclude windows directory, 
 # and common exe files present in Program Files directory
 # Add those files to FILES array and filenames to NAMES array

 search_list=$(find ${TEMPLATES_DIR}/* -maxdepth 0 -type d -print| tr '\n' '|')
 
 exe_found=$(echo ${search_list})
 
 if [ -z "${exe_found}" ] ; then
      zenity --error --title "${PROGNAME} - no templates found!" \
             --text "Sorry, no templates found in Templates directory"
      Main_Function
 fi
 # if exe_found has value, then only change exe
 for i in $(echo ${search_list}|tr '|' '\n'|sort)
 do
     RealName=$(basename "$i")
     RealFile=$(realpath -m "$i")
     
     # If 1st value is empty, enable it
     if [ -z "${SHOW_OPTION}" ]; then
          SHOW_OPTION+="TRUE \"${RealName}\""
          SHOW_OPTION+=" "
          NAMES+=("${RealName}")
          FILES+=("${RealFile}")
     else
          SHOW_OPTION+="0 \"${RealName}\""
          SHOW_OPTION+=" "
          NAMES+=("${RealName}")
          FILES+=("${RealFile}")
     fi
     count=$(expr ${count} + 1)
 done
 IFS=${SAVEIFS}

# 3. Show the found exe files using zenity
 unset COMMAND
 COMMAND+="zenity --title=\"${APP_WITH_VER}\" --text \"Templates\" --radiolist --list "
 COMMAND+="--hide-header --column \" \" --column \"Action\" ${SHOW_OPTION}"
 RESULT=$(eval ${COMMAND})
 
 if [ -z "${RESULT}" ]; then
      echo "Cancelled!"
      Main_Function
 fi
 
 count=0
# 4. Find which file the user selected and set the selected exe into variable
 for i in "${NAMES[@]}"; do 
     if [ "$i" = "$RESULT" ]; then
          echo "Selected $i"
          echo "File is ${FILES[${count}]}"
          export SELECTED_TEMPLATE="${FILES[${count}]}"
          break
     fi
     count=$(expr ${count} + 1)
 done
 
}
